
# A simple hand-made makefile for a package including applications
# built from Fortran 90 sources, taking into account the usual
# dependency cases.

# This makefile works with the GNU make command, the one find on
# GNU/Linux systems and often called gmake on non-GNU systems, if you
# are using an old style make command, please see the file
# Makefile_oldstyle provided with the package.

# ======================================================================
# Let's start with the declarations
# ======================================================================

# The compiler
FORTRAN_COMPILER = ifort
#FORTRAN_COMPILER = gfortran
# flags for debugging or for maximum performance, comment as necessary
OPT1 = -O2
OPT2 = -fstack-security-check
OPTPARALLEL = -fopenmp
DEBUG =  -debug all #-debug-parameters 
#-fbounds-check --->This is for gfortran
COMPILER_OPTS = $(OPT1) $(OPT2) $(DEBUG) $(OPTPARALLEL)
# name of the program
PROGRAM=main.e
#Function inside of the make
.SUFFIXES:
.SUFFIXES: .f90 .o
# List of executables to be built within the package
MOD1=global.o
MOD2=exponentialint.o
MOD3=functions.o
MOD4=subroutines.o
MODULES=$(MOD1) $(MOD2) $(MOD3) $(MOD4)

#Como si pusiera main:main.o global.o functions.o modinterf.o
$(PROGRAM):main.o $(MODULES) 
	 ${FORTRAN_COMPILER} $(COMPILER_OPTS) main.o $(MODULES) -o $(PROGRAM)

main.o:main.f90 $(MODULES) 
	$(FORTRAN_COMPILER) -c $(OPTPARALLEL) main.f90

$(MOD1):global.f90         #Como si pusiera global.o:global.f90
	$(FORTRAN_COMPILER) -c $(OPTPARALLEL) global.f90

$(MOD2):exponentialint.f90
	$(FORTRAN_COMPILER) -c $(OPTPARALLEL) exponentialint.f90

$(MOD3):functions.f90 $(MOD1)
	$(FORTRAN_COMPILER) -c $(OPTPARALLEL) functions.f90

$(MOD4):subroutines.f90 $(MOD1) $(MOD3)
	$(FORTRAN_COMPILER) -c $(OPTPARALLEL) subroutines.f90


clean:  #Este comando se corre con "make clean"
	-rm -f *.o *.mod


